import { readFile, writeFile } from 'fs/promises';

const pkgUrl = new URL('../package.json', import.meta.url);
const outputUrl = new URL('../../core/model/schema-version.js', import.meta.url);

const pkgText = await readFile(pkgUrl, 'utf8');
const pkg = JSON.parse(pkgText);
const schemaVersion = pkg.schemaVersion ?? '0.9.2';

const content = `// Auto-generated by cli/scripts/generate-schema-version.js\n` +
  `export const SCHEMA_VERSION = ${JSON.stringify(schemaVersion)};\n`;

await writeFile(outputUrl, content, 'utf8');
